<html>
<head>
    <title>Warmnest Furniture</title>
    <style>
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
}

a {
    color: inherit;
    text-decoration: none;
}

        .nav-header {
    display: flex;
    position: sticky;
    top: 0;
    z-index: 100;
    justify-content: space-between;
    align-items: center;
    padding: 15px 30px;
    background-color: #e3d8c8;
    border-bottom: 2px solid #5b3d29;
    border-top-left-radius: 10px;
    border-top-right-radius: 10px;
    gap: 20px; /* This adds space between the three main sections */
}

.nav-header input[type="text"] {
    padding: 8px 12px;
    border: 2px solid #5b3d29;
    border-radius: 6px;
    outline: none;
    width: 250px;
    font-size: 16px;
}

.nav-links {
    display: flex;
    align-items: center;
    gap: 40px;
    font-size: 20px;
    color: #5b3d29;
    font-family: 'Canva Sans', sans-serif;
}

.nav-links img {
    width: 30px;
    height: 30px;
}

.icons {
    display: flex;
    align-items: center;
    gap: 20px;
    font-size: 20px;
}

.page-wrapper {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
}

.filters {
    width: 200px;
    padding-right: 30px;
    color: #745943;
}

.filter-option {
    margin-bottom: 10px;
    cursor: pointer;
    transition: color 0.2s;
}

.filter-option:hover {
    color: #5b3d29;
}

footer {
    text-align: center;
    padding: 20px;
    border-top: 2px solid #745943;
    background-color: #e1d7c8;
	color: #745943;
    margin-top: auto;
}

.product-container {
    display: flex;
    flex-direction: column;
    padding: 40px;
    gap: 40px;
    max-width: 1400px;
    margin: 0 auto;
    width: 100%;
    box-sizing: border-box;
}

.product-main {
    display: flex;
    gap: 60px;
    width: 100%;
}

.product-images {
    flex: 1.2;
    display: flex;
    flex-direction: column;
    gap: 20px;
    min-width: 0;
}

.product-images img {
    width: 100%;
    border-radius: 8px;
    border: 2px solid #e3d8c8;
    max-height: 600px;
    object-fit: contain;
    background-color: white;
    box-shadow: 0 4px 8px rgba(0,0,0,0.05);
}

.product-details {
    flex: 1;
    padding: 20px;
    min-width: 0;
}

.product-title {
    font-size: 32px;
    margin-bottom: 10px;
    color: #5b3d29;
    line-height: 1.2;
}

.product-price {
    font-size: 28px;
    font-weight: bold;
    margin: 15px 0;
    color: #5b3d29;
}

.product-rating {
    color: #c59d5f;
    font-size: 20px;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 5px;
}

.section-title {
    font-size: 20px;
    margin: 25px 0 15px;
    color: #745943;
    border-bottom: 1px solid #e3d8c8;
    padding-bottom: 8px;
}

.product-description {
    line-height: 1.7;
    margin-bottom: 20px;
    font-size: 16px;
}

.color-options {
    display: flex;
    gap: 12px;
    margin: 15px 0;
    flex-wrap: wrap;
}

.color-circle {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    cursor: pointer;
    position: relative;
    transition: transform 0.2s;
    border: 2px solid transparent;
}

.color-circle:hover {
    transform: scale(1.1);
}

.color-circle.selected {
    border-color: #5b3d29;
}

.color-tooltip {
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    background: #5b3d29;
    color: white;
    padding: 6px 10px;
    border-radius: 4px;
    font-size: 12px;
    white-space: nowrap;
    visibility: hidden;
    opacity: 0;
    transition: all 0.2s;
    margin-bottom: 8px;
    z-index: 10;
}

.color-circle:hover .color-tooltip {
    visibility: visible;
    opacity: 1;
}

.selected-color {
    margin-top: 15px;
    font-weight: bold;
    color: #5b3d29;
    font-size: 16px;
}

.action-buttons {
    display: flex;
    flex-direction: column;
    gap: 15px;
    margin-top: 40px;
}

.primary-actions {
    display: flex;
    gap: 15px;
}

.secondary-actions {
    display: flex;
    gap: 15px;
    align-items: center;
    flex-wrap: wrap;
}

.buy-button {
    background-color: #5b3d29;
    color: white;
    border: none;
    padding: 14px 30px;
    font-size: 18px;
    border-radius: 6px;
    cursor: pointer;
    flex: 2;
    transition: all 0.3s ease;
    font-weight: bold;
}

.buy-button:hover {
    background-color: #745943;
}

.coupon-button {
    background-color: #c59d5f;
    color: white;
    border: none;
    padding: 14px 20px;
    font-size: 18px;
    border-radius: 6px;
    cursor: pointer;
    flex: 1;
    transition: all 0.3s ease;
    font-weight: bold;
}

.coupon-button:hover {
    background-color: #b38c4f;
}

.wishlist-button, .add-to-cart-small {
    background-color: #e3d8c8;
    color: #5b3d29;
    border: 2px solid #5b3d29;
    padding: 10px 18px;
    font-size: 16px;
    border-radius: 6px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s ease;
    font-weight: bold;
}

.wishlist-button:hover, .add-to-cart-small:hover {
    background-color: #d8cdbd;
}

.quantity-controls {
    display: flex;
    align-items: center;
    gap: 8px;
}

.quantity-button {
    background-color: #f0f0f0;
    color: #5b3d29;
    border: 1px solid #5b3d29;
    width: 36px;
    height: 36px;
    font-size: 18px;
    border-radius: 6px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
}

.quantity-button:hover {
    background-color: #e0e0e0;
}

.quantity-display {
    width: 50px;
    text-align: center;
    font-size: 18px;
    font-weight: bold;
}

.coupon-dropdown {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 220px;
    box-shadow: 0px 8px 16px rgba(0,0,0,0.1);
    z-index: 1;
    border-radius: 6px;
    padding: 12px;
    border: 1px solid #e3d8c8;
    margin-top: 5px;
}

.coupon-dropdown.show {
    display: block;
}

.coupon-option {
    padding: 10px 14px;
    cursor: pointer;
    border-bottom: 1px solid #f0f0f0;
    transition: all 0.2s ease;
    font-size: 15px;
}

.coupon-option:hover {
    background-color: #f9f5f0;
}

.coupon-option:last-child {
    border-bottom: none;
}

.discount-badge {
    background-color: #ff6666;
    color: white;
    padding: 3px 8px;
    border-radius: 4px;
    font-size: 13px;
    margin-left: 8px;
    font-weight: bold;
}

.reviews-section {
    margin-top: 30px;
    padding: 25px;
    background-color: #f9f5f0;
    border-radius: 8px;
    border: 1px solid #e3d8c8;
}

.review-stars {
    color: #c59d5f;
    font-size: 18px;
    margin-bottom: 12px;
}

.review-text {
    font-style: italic;
    margin-bottom: 12px;
    line-height: 1.6;
}

.see-more {
    color: #5b3d29;
    text-decoration: underline;
    cursor: pointer;
    font-weight: bold;
    display: inline-block;
    margin-top: 10px;
}

.recommended-products {
    margin-top: 50px;
    padding-top: 30px;
    border-top: 1px solid #e3d8c8;
    width: 100%;
}

.recommended-title {
    font-size: 24px;
    margin-bottom: 25px;
    color: #5b3d29;
}

.recommended-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
    gap: 25px;
}

.recommended-item {
    border: 1px solid #e3d8c8;
    border-radius: 8px;
    padding: 20px;
    transition: all 0.3s ease;
    cursor: pointer;
    background-color: white;
}

.recommended-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    border-color: #c59d5f;
}

.recommended-item img {
    width: 100%;
    height: 180px;
    object-fit: cover;
    border-radius: 6px;
    margin-bottom: 15px;
    border: 1px solid #e3d8c8;
}

.recommended-item h4 {
    margin: 0 0 8px 0;
    font-size: 18px;
    height: auto;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    min-height: 54px;
    line-height: 1.3;
}

.recommended-item .price {
    font-weight: bold;
    color: #5b3d29;
    font-size: 20px;
    margin: 8px 0;
}

.recommended-item .product-rating {
    font-size: 16px;
    margin-bottom: 0;
}

.modal {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1000;
    background-color: white;
    border: 2px solid #5b3d29;
    padding: 40px;
    border-radius: 10px;
    width: 90%;
    max-width: 700px;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
}

.modal.show {
    display: block;
}

.modal-content-container {
    display: flex;
    gap: 30px;
    margin-bottom: 30px;
}

.modal-product-image {
    width: 220px;
    height: 220px;
    object-fit: contain;
    border: 1px solid #e3d8c8;
    border-radius: 8px;
    background-color: white;
    padding: 10px;
}

.modal-product-info {
    flex: 1;
}

.modal h2 {
    font-size: 28px;
    margin-bottom: 20px;
    color: #5b3d29;
}

.modal-details-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 15px;
    align-items: center;
}

.modal-detail-label {
    font-weight: bold;
    font-size: 18px;
}

.modal-input-field {
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 6px;
    width: 70px;
    font-size: 16px;
    text-align: center;
}

.modal-total-section {
    border-top: 1px solid #e3d8c8;
    padding-top: 20px;
    margin-top: 20px;
}

.modal-total-label {
    font-weight: bold;
    font-size: 20px;
}

.modal-total-price-display {
    font-size: 22px;
    font-weight: bold;
    color: #5b3d29;
}

.modal-buttons {
    display: flex;
    justify-content: flex-end;
    gap: 20px;
    margin-top: 30px;
}

.checkout-button {
    background-color: #5b3d29;
    color: white;
    border: none;
    padding: 14px 30px;
    font-size: 18px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
    transition: background-color 0.3s;
}

.checkout-button:hover {
    background-color: #745943;
}

.close-modal {
    background-color: #e3d8c8;
    color: #5b3d29;
    border: none;
    padding: 14px 30px;
    font-size: 18px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
    transition: background-color 0.3s;
}

.close-modal:hover {
    background-color: #d8cdbd;
}

@media (max-width: 1200px) {
    .product-container {
        padding: 30px;
    }
    
    .product-main {
        gap: 40px;
    }
}

@media (max-width: 992px) {
    .nav-header {
        flex-direction: column;
        gap: 15px;
        padding: 15px;
    }
    
    .nav-header input[type="text"] {
            padding: 8px 12px;
            border: 2px solid #5b3d29;
            border-radius: 6px;
            outline: none;
        }
    
    .nav-links {
        gap: 20px;
        font-size: 18px;
    }
    
    .product-container {
        padding: 25px;
    }
}

@media (max-width: 768px) {
    .product-main {
        flex-direction: column;
        gap: 30px;
    }
    
    .product-images,
    .product-details {
        flex: none;
        width: 100%;
    }
    
    .primary-actions,
    .secondary-actions {
        flex-direction: column;
    }
    
    .buy-button,
    .coupon-button,
    .wishlist-button,
    .add-to-cart-small {
        width: 100%;
    }
    
    .modal {
        width: 95%;
        padding: 25px;
    }
    
    .modal-content-container {
        flex-direction: column;
        gap: 20px;
    }
    
    .modal-product-image {
        width: 100%;
        height: auto;
        max-height: 200px;
        margin: 0 auto;
    }
    
    .recommended-grid {
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    }
}

@media (max-width: 576px) {
    .product-container {
        padding: 15px;
    }
    
    .product-title {
        font-size: 26px;
    }
    
    .product-price {
        font-size: 24px;
    }
    
    .modal {
        width: 98%;
        padding: 20px;
    }
    
    .modal-buttons {
        flex-direction: column;
        gap: 10px;
    }
    
    .checkout-button,
    .close-modal {
        width: 100%;
    }
    
    .recommended-grid {
        grid-template-columns: 1fr;
    }
}

.logo {
      display: flex;
      align-items: center;
      font-size: 2em;
      font-family: 'Merriweather', serif;
    }

    .logo img {
      width: 30px;
      height: 30px;
      object-fit: contain;
    }
	
	.logo-search-container {
    display: flex;
    align-items: center;
    gap: 20px; /* Adjust this value to control the space between logo and search */
}
    </style>
</head>
<body>
   <div class="page-wrapper">
        <header class="nav-header">
    <div class="logo-search-container"> <!-- Add this wrapper div -->
        <div class="logo">
            <img src="Wvdb-images/homepage/logo.png" alt="Logo">
        </div>
        <input type="text" placeholder="Search" id="store-search-input">
    </div>
    <div class="nav-links">
        <a href="store.html"><div>Store</div></a>
        <a href="home.html"><div>Home</div></a>
        <a href="customer-support.html"><div>About us</div></a>
    </div>
    <div class="icons">
        <a href="profile.html" class="icon-link">ðŸ‘¤</a>
        <a href="wishlist.html" class="icon-link">â˜†</a>
        <a href="cart.html" class="icon-link">ðŸ›’</a>
    </div>
</header>
        

            <div class="product-container" id="product-container"></div>
        </div>

        <footer>
            <p>Â© 2025 Warm Nest Furniture. All rights reserved.</p>
        </footer>
    </div>
    
     <div class="modal" id="buyModal">
    <div class="modal-content-container">
        <img id="modalProductImage" src="" alt="Product" class="modal-product-image">
        <div class="modal-product-info">
            <h2 id="modalProductName">Product Name</h2>
            <div class="modal-details-row">
                <p class="modal-detail-label">Price:</p>
                <p id="modalProductPrice">â‚±0</p>
            </div>
            <div class="modal-details-row">
                <label for="modalQuantity" class="modal-detail-label">Quantity:</label>
                <input type="number" id="modalQuantity" value="1" min="1" class="modal-input-field">
            </div>
            <div class="modal-details-row">
                <p class="modal-detail-label">Discount:</p>
                <span id="modalDiscountDisplay">No discount applied</span>
            </div>
        </div>
    </div>
    
    <div class="modal-total-section">
        <div class="modal-details-row">
            <p class="modal-total-label">Subtotal:</p>
            <span id="modalSubtotalPrice" class="modal-total-price-display">â‚±0</span>
        </div>
        <div class="modal-details-row">
            <p class="modal-total-label">Total:</p>
            <span id="modalTotalPrice" class="modal-total-price-display">â‚±0</span>
        </div>
    </div>

    <div class="modal-buttons">
        <button class="close-modal" id="closeModal">Close</button>
        <button class="checkout-button" id="checkoutButton">Checkout</button>
    </div>
</div>

	<script src = "script/shared.js"></script>
    <script>
	 // Define products array first
        const products = [
        {
                    "id": "beanbag",
                    "name": "Bean Bag",
                    "price": 30000,
                    "rating": 5,
                    "weight": 15,
                    "width": 70,
                    "height": 80,
                    "depth": 60,
					"defaultColor": "#ccff66", // Add this line
					"color": "#ccff66",
					"availableColors": [
					{"code": "#5b3218", "name": "Dark Brown", "priceAdjustment": 0},
					{"code": "#5a4e4b", "name": "Gray Brown", "priceAdjustment": 1500},
					{"code": "#00429d", "name": "Navy Blue", "priceAdjustment": 2000},
					{"code": "#ccff66", "name": "Lime Green", "priceAdjustment": 1000}
				],
                    "material": "Leather",
                    "images": ["Wvdb-images/Chair/beanbag-4.jpg"],
                    "description": "Faux Leather 75 cm diameter 110 cm height filled with fresh virgin polystyrene beans. Double stitching for extra strong hold. Product weight with filling â€“ 5 kgs with lining fabric at the base so the beans don't come out easily."
                },
                {
                    "id": "sofa",
                    "name": "Sofa",
                    "price": 40000,
                    "rating": 4,
                    "weight": 45,
                    "width": 200,
                    "height": 80,
                    "depth": 90,
					"defaultColor": "#666666", // Add this line
					"color": "#666666",
					"availableColors": [
					{"code": "#5b3218", "name": "Dark Brown", "priceAdjustment": 0},
					{"code": "#5a4e4b", "name": "Gray Brown", "priceAdjustment": 1500},
					{"code": "#00429d", "name": "Navy Blue", "priceAdjustment": 2000},
					{"code": "#666666", "name": "Charcoal", "priceAdjustment": 1000}
				],
                    "material": "Fabric",
                    "images": ["Wvdb-images/living-room/19.jpg"],
                    "description": "Comfortable 3-seater sofa with high-density foam cushions and durable fabric upholstery. Perfect for living rooms with modern decor."
                },
                {
                    "id": "chair",
                    "name": "Chair",
                    "price": 10000,
                    "rating": 3,
                    "weight": 8,
                    "width": 50,
                    "height": 90,
                    "depth": 50,
					"defaultColor": "#666666", // Add this line
					"color": "#666666",
					"availableColors": [
					{"code": "#5b3218", "name": "Dark Brown", "priceAdjustment": 0},
					{"code": "#5a4e4b", "name": "Gray Brown", "priceAdjustment": 1500},
					{"code": "#00429d", "name": "Navy Blue", "priceAdjustment": 2000},
					{"code": "#666666", "name": "Charcoal", "priceAdjustment": 1000}
				],
                    "material": "Wood",
                    "images": ["Wvdb-images/Chair/chair5.jpg"],
                    "description": "Classic wooden chair with comfortable cushion."
                },
                {
                    "id": "table",
                    "name": "Coffee Table",
                    "price": 15000,
                    "rating": 4,
                    "weight": 25,
                    "width": 120,
                    "height": 45,
                    "depth": 60,
					"defaultColor": "#5a4e4b", // Add this line
					"color": "#5a4e4b",
					"availableColors": [
					{"code": "#5b3218", "name": "Dark Brown", "priceAdjustment": 0},
					{"code": "#5a4e4b", "name": "Gray Brown", "priceAdjustment": 1500},
					{"code": "#00429d", "name": "Navy Blue", "priceAdjustment": 2000},
					{"code": "#666666", "name": "Charcoal", "priceAdjustment": 1000}
				],
                    "material": "Glass/Metal",
                    "images": ["Wvdb-images/living-room/table.jpg"],
                    "description": "Modern glass-top coffee table with metal frame."
                },
                {
                    "id": "bookshelf",
                    "name": "Bookshelf",
                    "price": 22000,
                    "rating": 4,
                    "weight": 35,
                    "width": 80,
                    "height": 180,
                    "depth": 30,
                    "material": "Wood",
					"defaultColor": "#666666", // Add this line
					"color": "#666666",
					"availableColors": [
					{"code": "#5b3218", "name": "Dark Brown", "priceAdjustment": 0},
					{"code": "#5a4e4b", "name": "Gray Brown", "priceAdjustment": 1500},
					{"code": "#00429d", "name": "Navy Blue", "priceAdjustment": 2000},
					{"code": "#666666", "name": "Charcoal", "priceAdjustment": 1000}
				],
                    "images": ["Wvdb-images/living-room/book.jpeg"],
                    "description": "5-tier wooden bookshelf with ample storage space."
                },
                {
                    "id": "bed1",
                    "name": "Queen Bed",
                    "price": 50000,
                    "rating": 5,
                    "weight": 80,
                    "width": 160,
                    "height": 100,
                    "depth": 200,
					"defaultColor": "#00429d", // Add this line
					"color": "#00429d",
					"availableColors": [
					{"code": "#5b3218", "name": "Dark Brown", "priceAdjustment": 0},
					{"code": "#5a4e4b", "name": "Gray Brown", "priceAdjustment": 1500},
					{"code": "#00429d", "name": "Navy Blue", "priceAdjustment": 2000},
					{"code": "#666666", "name": "Charcoal", "priceAdjustment": 1000}
				],	
                    "material": "Wood/Fabric",
                    "images": ["Wvdb-images/bed/bed21.jpg"],
                    "description": "Solid wood queen bed frame with upholstered headboard."
                },
				{
            "id": "bed2",
            "name": "King Bed",
            "price": 50000,
            "rating": 5,
            "weight": 90,
            "width": 180,
            "height": 100,
            "depth": 210,
            "defaultColor": "#e3d8c8",
            "color": "#e3d8c8",
            "availableColors": [
                {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
                {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1500},
                {"code": "#00429d", "name": "Navy Blue", "priceAdjustment": 2000}
            ],
            "material": "Wood/Fabric",
            "images": ["Wvdb-images/bed/bed23.jpg"],
            "description": "Luxury king size bed with premium fabric upholstery."
        },
        {
            "id": "bed3",
            "name": "Single Bed",
            "price": 20000,
            "rating": 3,
            "weight": 50,
            "width": 100,
            "height": 80,
            "depth": 190,
            "defaultColor": "#5b3d29",
            "color": "#5b3d29",
            "availableColors": [
                {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
                {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1500}
            ],
            "material": "Wood",
            "images": ["Wvdb-images/bed/bed12.jpg"],
            "description": "Classic single bed frame with sturdy wooden construction."
        },
        {
            "id": "bed4",
            "name": "Bunk Bed",
            "price": 35000,
            "rating": 4,
            "weight": 70,
            "width": 100,
            "height": 160,
            "depth": 190,
            "defaultColor": "#5b3d29",
            "color": "#5b3d29",
            "availableColors": [
                {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
                {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1500}
            ],
            "material": "Wood/Metal",
            "images": ["Wvdb-images/bed/25.jpg"],
            "description": "Space-saving bunk bed with safety rails."
        },
        {
            "id": "bed5",
            "name": "Canopy Bed",
            "price": 60000,
            "rating": 5,
            "weight": 85,
            "width": 160,
            "height": 150,
            "depth": 200,
            "defaultColor": "#e3d8c8",
            "color": "#e3d8c8",
            "availableColors": [
                {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
                {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1500}
            ],
            "material": "Wood/Fabric",
            "images": ["Wvdb-images/bed/24.jpg"],
            "description": "Elegant canopy bed with luxurious fabric drapes."
        },
        {
            "id": "bed6",
            "name": "Daybed",
            "price": 25000,
            "rating": 4,
            "weight": 45,
            "width": 140,
            "height": 80,
            "depth": 80,
            "defaultColor": "#5b3d29",
            "color": "#5b3d29",
            "availableColors": [
                {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
                {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1500}
            ],
            "material": "Wood/Fabric",
            "images": ["Wvdb-images/bed/bed8.jpeg"],
            "description": "Versatile daybed perfect for lounging or sleeping."
        },
		
		{
        "id": "dining1",
        "name": "6-Seater Dining Set",
        "price": 45000,
        "rating": 4,
        "weight": 75,
        "width": 180,
        "height": 75,
        "depth": 100,
        "defaultColor": "#5b3d29",
        "color": "#5b3d29",
        "availableColors": [
            {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
            {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1500},
            {"code": "#00429d", "name": "Navy Blue", "priceAdjustment": 2000}
        ],
        "material": "Wood/Glass",
        "images": ["Wvdb-images/set/6.jpg"],
        "description": "Elegant 6-seater dining table with matching chairs and glass top."
    },
    {
        "id": "dining2",
        "name": "4-Seater Dining Set",
        "price": 35000,
        "rating": 5,
        "weight": 60,
        "width": 140,
        "height": 75,
        "depth": 80,
        "defaultColor": "#e3d8c8",
        "color": "#e3d8c8",
        "availableColors": [
            {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
            {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1500},
            {"code": "#00429d", "name": "Navy Blue", "priceAdjustment": 2000}
        ],
        "material": "Wood",
        "images": ["Wvdb-images/set/5.jpg"],
        "description": "Compact 4-seater dining set perfect for small spaces."
    },
    {
        "id": "dining3",
        "name": "Extendable Dining Table",
        "price": 40000,
        "rating": 3,
        "weight": 65,
        "width": 120,
        "height": 75,
        "depth": 80,
        "defaultColor": "#5b3d29",
        "color": "#5b3d29",
        "availableColors": [
            {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
            {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1500}
        ],
        "material": "Wood",
        "images": ["Wvdb-images/set/4.jpg"],
        "description": "Versatile extendable table that seats 4-8 people."
    },
    {
        "id": "dining4",
        "name": "Bar Table Set",
        "price": 30000,
        "rating": 4,
        "weight": 50,
        "width": 100,
        "height": 110,
        "depth": 60,
        "defaultColor": "#5b3d29",
        "color": "#5b3d29",
        "availableColors": [
            {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
            {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1500}
        ],
        "material": "Wood/Metal",
        "images": ["Wvdb-images/set/3.jpg"],
        "description": "Modern bar table set with 4 stools."
    },
    {
        "id": "dining5",
        "name": "Outdoor Dining Set",
        "price": 55000,
        "rating": 5,
        "weight": 80,
        "width": 160,
        "height": 75,
        "depth": 90,
        "defaultColor": "#e3d8c8",
        "color": "#e3d8c8",
        "availableColors": [
            {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
            {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1500}
        ],
        "material": "Rattan/Glass",
        "images": ["Wvdb-images/set/2.jpg"],
        "description": "Weather-resistant outdoor dining set with 6 chairs."
    },
    {
        "id": "dining6",
        "name": "Breakfast Nook Set",
        "price": 28000,
        "rating": 4,
        "weight": 55,
        "width": 120,
        "height": 75,
        "depth": 70,
        "defaultColor": "#5b3d29",
        "color": "#5b3d29",
        "availableColors": [
            {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
            {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1500}
        ],
        "material": "Wood/Fabric",
        "images": ["Wvdb-images/set/1.jpg"],
        "description": "Cozy breakfast nook set with bench seating."
    }, 
	
	{
        "id": "sofa1",
        "name": "3-Seater Sofa",
        "price": 35000,
        "rating": 4,
        "weight": 65,
        "width": 200,
        "height": 85,
        "depth": 90,
        "defaultColor": "#5b3d29",
        "color": "#5b3d29",
        "availableColors": [
            {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
            {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1500},
            {"code": "#00429d", "name": "Navy Blue", "priceAdjustment": 2000}
        ],
        "material": "Fabric",
        "images": ["Wvdb-images/living-room/1.jpg"],
        "description": "Comfortable 3-seater sofa with high-density foam cushions and durable fabric upholstery."
    },
    {
        "id": "sofa2",
        "name": "L-Shaped Sectional",
        "price": 55000,
        "rating": 5,
        "weight": 95,
        "width": 280,
        "height": 85,
        "depth": 160,
        "defaultColor": "#e3d8c8",
        "color": "#e3d8c8",
        "availableColors": [
            {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
            {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1500},
            {"code": "#00429d", "name": "Navy Blue", "priceAdjustment": 2000}
        ],
        "material": "Leather",
        "images": ["Wvdb-images/living-room/13.jpg"],
        "description": "Premium L-shaped sectional sofa with genuine leather upholstery and reclining features."
    },
    {
        "id": "sofa3",
        "name": "2-Seater Loveseat",
        "price": 28000,
        "rating": 3,
        "weight": 45,
        "width": 160,
        "height": 85,
        "depth": 85,
        "defaultColor": "#5b3d29",
        "color": "#5b3d29",
        "availableColors": [
            {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
            {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1500}
        ],
        "material": "Velvet",
        "images": ["Wvdb-images/living-room/26.jpg"],
        "description": "Elegant 2-seater loveseat with plush velvet upholstery and wooden legs."
    },
    {
        "id": "sofa4",
        "name": "Sofa Bed",
        "price": 40000,
        "rating": 4,
        "weight": 70,
        "width": 190,
        "height": 90,
        "depth": 95,
        "defaultColor": "#5b3d29",
        "color": "#5b3d29",
        "availableColors": [
            {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
            {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1500}
        ],
        "material": "Fabric",
        "images": ["Wvdb-images/living-room/33.jpg"],
        "description": "Versatile sofa that converts into a comfortable bed for guests."
    },
    {
        "id": "sofa5",
        "name": "Modern Chaise Lounge",
        "price": 45000,
        "rating": 5,
        "weight": 60,
        "width": 180,
        "height": 80,
        "depth": 100,
        "defaultColor": "white",
        "color": "white",
        "availableColors": [
            {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
            {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1500},
			{"code": "white", "name": "White", "priceAdjustment": 2000}
        ],
        "material": "Microfiber",
        "images": ["Wvdb-images/living-room/17.jpg"],
        "description": "Sleek modern chaise lounge with ergonomic design and premium microfiber fabric."
    },
    {
        "id": "sofa6",
        "name": "Recliner Sofa Set",
        "price": 60000,
        "rating": 4,
        "weight": 85,
        "width": 220,
        "height": 90,
        "depth": 100,
        "defaultColor": "#e3d8c8",
        "color": "#e3d8c8",
        "availableColors": [
            {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
            {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1500}
        ],
        "material": "Leather",
        "images": ["Wvdb-images/living-room/40.jpg"],
        "description": "Luxury recliner sofa set with power reclining mechanism and premium leather upholstery."
    },
	{
        "id": "living1",
        "name": "Coffee Table",
        "price": 18000,
        "rating": 4,
        "weight": 25,
        "width": 120,
        "height": 45,
        "depth": 60,
        "defaultColor": "#5b3d29",
        "color": "#5b3d29",
        "availableColors": [
            {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
            {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1500},
            {"code": "#666666", "name": "Charcoal", "priceAdjustment": 1000}
        ],
        "material": "Wood/Glass",
        "images": ["Wvdb-images/living-room/47.jpg"],
        "description": "Modern rectangular coffee table with tempered glass top and wooden frame."
    },
    {
        "id": "living2",
        "name": "TV Stand",
        "price": 22000,
        "rating": 5,
        "weight": 35,
        "width": 160,
        "height": 50,
        "depth": 40,
        "defaultColor": "#5b3d29",
        "color": "#5b3d29",
        "availableColors": [
            {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
            {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1500}
        ],
        "material": "Wood/Metal",
        "images": ["Wvdb-images/living-room/46.jpg"],
        "description": "Stylish TV stand with cable management and ample storage space."
    },
    {
        "id": "living3",
        "name": "Bookshelf",
        "price": 25000,
        "rating": 4,
        "weight": 30,
        "width": 80,
        "height": 180,
        "depth": 30,
        "defaultColor": "#e3d8c8",
        "color": "#e3d8c8",
        "availableColors": [
            {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
            {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1500}
        ],
        "material": "Wood",
        "images": ["Wvdb-images/living-room/45.jpg"],
        "description": "5-tier wooden bookshelf with adjustable shelves for versatile storage."
    },
    {
        "id": "living4",
        "name": "Entertainment Center",
        "price": 40000,
        "rating": 5,
        "weight": 60,
        "width": 200,
        "height": 180,
        "depth": 50,
        "defaultColor": "#5b3d29",
        "color": "#5b3d29",
        "availableColors": [
            {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
            {"code": "#666666", "name": "Charcoal", "priceAdjustment": 1000}
        ],
        "material": "Engineered Wood",
        "images": ["Wvdb-images/living-room/44.jpg"],
        "description": "Complete entertainment center with space for TV, components, and media storage."
    },
    {
        "id": "living5",
        "name": "Accent Chair",
        "price": 15000,
        "rating": 4,
        "weight": 15,
        "width": 70,
        "height": 85,
        "depth": 70,
        "defaultColor": "#00429d",
        "color": "#00429d",
        "availableColors": [
            {"code": "#00429d", "name": "Navy Blue", "priceAdjustment": 0},
            {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 1500}
        ],
        "material": "Fabric",
        "images": ["Wvdb-images/living-room/43.jpeg"],
        "description": "Comfortable accent chair with stylish design, perfect for living rooms."
    },
    {
        "id": "living6",
        "name": "Console Table",
        "price": 20000,
        "rating": 3,
        "weight": 20,
        "width": 120,
        "height": 75,
        "depth": 35,
        "defaultColor": "#e3d8c8",
        "color": "#e3d8c8",
        "availableColors": [
            {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 0},
            {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 1500}
        ],
        "material": "Wood/Metal",
        "images": ["Wvdb-images/living-room/ct.jpg"],
        "description": "Sleek console table perfect for hallways or behind sofas."
    },
    {
        "id": "living7",
        "name": "Side Table Set",
        "price": 12000,
        "rating": 4,
        "weight": 15,
        "width": 50,
        "height": 55,
        "depth": 50,
        "defaultColor": "#5b3d29",
        "color": "#5b3d29",
        "availableColors": [
            {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 0},
            {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 1000}
        ],
        "material": "Wood",
        "images": ["Wvdb-images/living-room/st.jpg"],
        "description": "Set of two matching side tables with drawer storage."
    },
    {
        "id": "living8",
        "name": "Display Cabinet",
        "price": 35000,
        "rating": 5,
        "weight": 45,
        "width": 100,
        "height": 190,
        "depth": 40,
        "defaultColor": "#e3d8c8",
        "color": "#e3d8c8",
        "availableColors": [
            {"code": "#e3d8c8", "name": "Beige", "priceAdjustment": 0},
            {"code": "#5b3d29", "name": "Dark Brown", "priceAdjustment": 2000}
        ],
        "material": "Wood/Glass",
        "images": ["Wvdb-images/living-room/dc.jpg"],
        "description": "Elegant display cabinet with glass doors and interior lighting."
    }
            ];
			
	window.addToCart = function(productId, quantity = 1) {
    const product = products.find(p => p.id === productId);
    if (product) {
        // Show confirmation alert
        const userConfirmed = confirm(`Add ${quantity} x ${product.name} to your cart?`);
        
        if (userConfirmed) {
            const colorSelection = JSON.parse(localStorage.getItem(`productColor_${product.id}`)) || {
                code: product.defaultColor,
                name: product.availableColors.find((c) => c.code === product.defaultColor).name
            };

            const cartItem = {
                id: product.id,
                name: product.name,
                price: product.price,
                color: colorSelection,
                quantity: quantity,
                image: product.images[0]
            };

            let cart = JSON.parse(localStorage.getItem("cart")) || [];
            
            // Check if item already exists in cart
            const existingItemIndex = cart.findIndex(item => 
                item.id === productId && 
                item.color.code === colorSelection.code
            );
            
            if (existingItemIndex >= 0) {
                // Update quantity if item exists
                cart[existingItemIndex].quantity += quantity;
            } else {
                // Add new item if it doesn't exist
                cart.push(cartItem);
            }
            
            localStorage.setItem("cart", JSON.stringify(cart));
            alert(`${quantity} x ${product.name} has been added to your cart!`);
            
            // Update cart count in header
            updateCartCount();
        }
    }
};


 let selectedProduct = null;
let quantity = 1;
let selectedCoupon = null;

// Function to display product
function displayProduct(product) {
    const container = document.getElementById("product-container");
    const savedColor = JSON.parse(localStorage.getItem(`productColor_${product.id}`));
    const currentColor = savedColor || {
        code: product.defaultColor,
        name: product.availableColors.find((c) => c.code === product.defaultColor).name
    };

    container.innerHTML = `
        <div class="product-main">
            <div class="product-images">
                <img src="${product.images[0]}" alt="${product.name}">
                <div class="reviews-section">
                    <h3 class="section-title">REVIEWS</h3>
                    <div class="review-stars">
                        ${"â˜…".repeat(product.rating)}${"â˜†".repeat(5 - product.rating)}
                    </div>
                    <p class="review-text">${product.description || "No reviews yet."}</p>
                    <p>0 Reviews</p>
                    <p class="see-more">See more ></p>
                </div>
            </div>

            <div class="product-details">
                <h1 class="product-title">${product.name}</h1>
                <div class="product-rating">
                    ${"â˜…".repeat(product.rating)}${"â˜†".repeat(5 - product.rating)}
                </div>
                <div class="product-price">â‚±${product.price.toLocaleString()}.00</div>
                
                <h3 class="section-title">Product color</h3>
                <div class="color-options">
                    ${product.availableColors
                        .map(
                            (color) => `
                    <div class="color-circle ${color.code === currentColor.code ? "selected" : ""}" 
                         style="background-color: ${color.code}"
                         onclick="selectProductColor('${product.id}', '${color.code}', '${color.name}')">
                        <span class="color-tooltip">${color.name}</span>
                    </div>
                `
                        )
                        .join("")}
                </div>
                <p class="selected-color">${currentColor.name}</p>
                
                <h3 class="section-title">Description</h3>
                <p class="product-description">${product.description}</p>
                
                <h3 class="section-title">Dimensions</h3>
                <p>${product.depth}D Ã— ${product.width}W Ã— ${product.height}H centimeters</p>
                <p>Material: ${product.material}</p>
                <p>Weight: ${product.weight} lbs</p>
                
                <div class="action-buttons">
                    <div class="secondary-actions">
                        <button class="wishlist-button" onclick="toggleWishlist('${product.id}')">
    â™¡ Wishlist
</button>
                        <button class="add-to-cart-small" onclick="addToCart('${product.id}')">
                            ðŸ›’ Add to Cart
                        </button>
                        <div class="quantity-controls">
                            <button class="quantity-button" onclick="decreaseQuantity()">-</button>
                            <span class="quantity-display" id="quantity">1</span>
                            <button class="quantity-button" onclick="increaseQuantity()">+</button>
                        </div>
                    </div>
                    
                    <div class="primary-actions">
                        <button class="buy-button" id="buyButton" data-product-id="${product.id}">Buy</button>
                        
                        <div class="coupon-container">
                            <button class="coupon-button" onclick="toggleCouponDropdown()">
                                Coupon â–¼
                            </button>
                            <div class="coupon-dropdown" id="couponDropdown">
                                <div class="coupon-option" onclick="selectCoupon(15, 'Summer Sale')">
                                    Summer Sale <span class="discount-badge">15% OFF</span>
                                </div>
                                <div class="coupon-option" onclick="selectCoupon(10, 'New Customer')">
                                    New Customer <span class="discount-badge">10% OFF</span>
                                </div>
                                <div class="coupon-option" onclick="selectCoupon(20, 'Clearance')">
                                    Clearance <span class="discount-badge">20% OFF</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recommended Products Section -->
                <div class="recommended-products">
                    <h3 class="recommended-title">You might also like</h3>
                    <div class="recommended-grid" id="recommendedProducts">
                        <!-- Recommended products will be inserted here by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    `;

    quantity = 1;
    updateQuantity();
    displayRecommendedProducts(product);
}
function toggleWishlist(productId) {
        const product = products.find(p => p.id === productId);
        if (!product) return;

        let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
        const existingIndex = wishlist.findIndex(item => item.id === productId);

        if (existingIndex >= 0) {
            // Remove from wishlist
            wishlist.splice(existingIndex, 1);
            localStorage.setItem('wishlist', JSON.stringify(wishlist));
            alert(`${product.name} removed from your wishlist!`);
        } else {
            // Add to wishlist
            const wishlistItem = {
                id: product.id,
                name: product.name,
                price: product.price,
                image: product.images[0]
            };
            wishlist.push(wishlistItem);
            localStorage.setItem('wishlist', JSON.stringify(wishlist));
            alert(`${product.name} added to your wishlist!`);
        }

        updateWishlistButton(productId);
    }

    function updateWishlistButton(productId) {
        const wishlistButton = document.querySelector('.wishlist-button');
        if (!wishlistButton) return;

        const wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
        const isInWishlist = wishlist.some(item => item.id === productId);

        if (isInWishlist) {
            wishlistButton.innerHTML = 'â™¥ In Wishlist';
            wishlistButton.style.backgroundColor = '#f0e6d6';
        } else {
            wishlistButton.innerHTML = 'â™¡ Wishlist';
            wishlistButton.style.backgroundColor = '#e3d8c8';
        }
    }
	
// Function to display recommended products
function displayRecommendedProducts(currentProduct) {
    let category = '';
    if (currentProduct.id.includes('bed')) {
        category = 'bed';
    } else if (currentProduct.id.includes('sofa')) {
        category = 'sofa';
    } else if (currentProduct.id.includes('dining')) {
        category = 'dining';
    } else if (currentProduct.id.includes('living')) {
        category = 'living';
    } else {
        category = 'living';
    }

    const recommended = products.filter(p => 
        p.id.includes(category) && p.id !== currentProduct.id
    );

    const container = document.getElementById("recommendedProducts");
    
    if (recommended.length > 0) {
        container.innerHTML = recommended.slice(0, 4).map(product => `
            <div class="recommended-item" onclick="window.location.href='product.html?id=${product.id}'">
                <img src="${product.images[0]}" alt="${product.name}">
                <h4>${product.name}</h4>
                <div class="price">â‚±${product.price.toLocaleString()}</div>
                <div class="product-rating">
                    ${"â˜…".repeat(product.rating)}${"â˜†".repeat(5 - product.rating)}
                </div>
            </div>
        `).join('');
    } else {
        container.innerHTML = '<p>No recommended products found.</p>';
    }
}

function updateQuantity() {
    document.getElementById("quantity").textContent = quantity;
}

function increaseQuantity() {
    quantity++;
    updateQuantity();
}

function decreaseQuantity() {
    if (quantity > 1) {
        quantity--;
        updateQuantity();
    }
}

function selectProductColor(productId, colorCode, colorName) {
    const productDiv = document.getElementById("product-container");
    const colorCircles = productDiv.querySelectorAll(".color-circle");
    colorCircles.forEach(circle => {
        circle.classList.remove("selected");
    });

    const selectedCircle = productDiv.querySelector(`.color-circle[style*="${colorCode}"]`);
    if (selectedCircle) {
        selectedCircle.classList.add("selected");
    }

    productDiv.querySelector(".selected-color").textContent = `${colorName}`;
    localStorage.setItem(`productColor_${productId}`, JSON.stringify({ code: colorCode, name: colorName }));
}

function selectCoupon(discountPercent, couponName) {
    selectedCoupon = {
        percent: discountPercent,
        name: couponName
    };
    alert(`Applied ${couponName} coupon (${discountPercent}% off)!`);
    document.getElementById("couponDropdown").classList.remove("show");
    updateModalPrices();
}

function toggleCouponDropdown() {
    document.getElementById("couponDropdown").classList.toggle("show");
}

function addToCart(productId) {
const product = products.find(p => p.id === productId);
    if (product) {
        const colorSelection = JSON.parse(localStorage.getItem(`productColor_${product.id}`)) || {
            code: product.defaultColor,
            name: product.availableColors.find((c) => c.code === product.defaultColor).name
        };

        const cartItem = {
            id: product.id,
            name: product.name,
            price: product.price,
            color: colorSelection,
            quantity: quantity,
            image: product.images[0]
        };

        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        
        // Check if item already exists in cart
        const existingItemIndex = cart.findIndex(item => 
            item.id === productId && 
            item.color.code === colorSelection.code
        );
        
        if (existingItemIndex >= 0) {
            // Update quantity if item exists
            cart[existingItemIndex].quantity += quantity;
        } else {
            // Add new item if it doesn't exist
            cart.push(cartItem);
        }
        
        localStorage.setItem("cart", JSON.stringify(cart));
        alert(`${quantity} x ${product.name} added to cart!`);
        updateCartCount(); // Update the cart count display
    }
}

// Initialize the page
document.addEventListener('DOMContentLoaded', function() {
    const urlParams = new URLSearchParams(window.location.search);
    const productId = urlParams.get("id");
    const product = products.find((p) => p.id === productId) || products[0];
    displayProduct(product);
	updateWishlistButton(product.id);

    const buyModal = document.getElementById("buyModal");
    const closeModalButton = document.getElementById("closeModal");
    const checkoutButton = document.getElementById("checkoutButton");
    const modalQuantity = document.getElementById("modalQuantity");
    const modalProductName = document.getElementById("modalProductName");
    const modalProductPrice = document.getElementById("modalProductPrice");
    const modalTotalPrice = document.getElementById("modalTotalPrice");
    const modalSubtotalPrice = document.getElementById("modalSubtotalPrice");
    const modalProductImage = document.getElementById("modalProductImage");
    const modalDiscountDisplay = document.getElementById("modalDiscountDisplay");

    // Initialize cart count immediately
    updateCartCount();

    document.addEventListener("click", function(event) {
        if (event.target.classList.contains("buy-button")) {
            const productId = event.target.getAttribute("data-product-id");
            selectedProduct = products.find((p) => p.id === productId);

            if (selectedProduct) {
                modalProductImage.src = selectedProduct.images[0];
                modalProductImage.alt = selectedProduct.name;
                modalProductName.textContent = selectedProduct.name;
                modalProductPrice.textContent = `â‚±${selectedProduct.price.toLocaleString()}`;
                modalQuantity.value = quantity;
                
                updateModalPrices();
                buyModal.classList.add("show");
            }
        }
    });

    closeModalButton.addEventListener("click", function() {
        buyModal.classList.remove("show");
    });

    function updateModalPrices() {
        if (!selectedProduct) return;
        
        const currentQuantity = parseInt(modalQuantity.value) || 1;
        const subtotal = selectedProduct.price * currentQuantity;
        
        const discountPercent = selectedCoupon ? selectedCoupon.percent : 0;
        const discountAmount = subtotal * (discountPercent / 100);
        const total = subtotal - discountAmount;

        modalSubtotalPrice.textContent = `â‚±${subtotal.toLocaleString()}`;
        modalTotalPrice.textContent = `â‚±${total.toLocaleString()}`;
        
        if (selectedCoupon) {
            modalDiscountDisplay.innerHTML = `
                <span class="discount-badge">${selectedCoupon.percent}% OFF (${selectedCoupon.name})</span>
            `;
        } else {
            modalDiscountDisplay.innerHTML = "No discount applied";
        }
    }

    modalQuantity.addEventListener("input", updateModalPrices);

    checkoutButton.addEventListener("click", function() {
        const currentQuantity = parseInt(modalQuantity.value) || 1;
    const productId = selectedProduct.id;
    
    // Show confirmation alert
    const userConfirmed = confirm(`Add ${currentQuantity} x ${selectedProduct.name} to your cart and proceed to checkout?`);
    
    if (userConfirmed) {
        const colorSelection = JSON.parse(localStorage.getItem(`productColor_${productId}`)) || {
            code: selectedProduct.defaultColor,
            name: selectedProduct.availableColors.find((c) => c.code === selectedProduct.defaultColor).name
        };

        const cartItem = {
            id: productId,
            name: selectedProduct.name,
            price: selectedProduct.price,
            color: colorSelection,
            quantity: currentQuantity,
            image: selectedProduct.images[0],
            coupon: selectedCoupon
        };

        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        
        // Check if item already exists in cart
        const existingItemIndex = cart.findIndex(item => 
            item.id === productId && 
            item.color.code === colorSelection.code
        );
        
        if (existingItemIndex >= 0) {
            // Update quantity if item exists
            cart[existingItemIndex].quantity += currentQuantity;
        } else {
            // Add new item if it doesn't exist
            cart.push(cartItem);
        }
        
        localStorage.setItem("cart", JSON.stringify(cart));
        updateCartCount();
        
        buyModal.classList.remove("show");
        window.location.href = "cart.html"; // Redirect to cart page
    }
});

    window.onclick = function(event) {
        if (!event.target.matches(".coupon-button")) {
            const dropdowns = document.getElementsByClassName("coupon-dropdown");
            for (let i = 0; i < dropdowns.length; i++) {
                const openDropdown = dropdowns[i];
                if (openDropdown.classList.contains("show")) {
                    openDropdown.classList.remove("show");
                }
            }
        }
    };
});

// Add this after the DOMContentLoaded event listener
function addToCart(productId) {
    const product = products.find(p => p.id === productId);
    if (product) {
        const colorSelection = JSON.parse(localStorage.getItem(`productColor_${product.id}`)) || {
            code: product.defaultColor,
            name: product.availableColors.find((c) => c.code === product.defaultColor).name
        };

        const cartItem = {
            id: product.id,
            name: product.name,
            price: product.price,
            color: colorSelection,
            quantity: quantity,
            image: product.images[0]
        };

        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        
        // Check if item already exists in cart
        const existingItemIndex = cart.findIndex(item => 
            item.id === productId && 
            item.color.code === colorSelection.code
        );
        
        if (existingItemIndex >= 0) {
            // Update quantity if item exists
            cart[existingItemIndex].quantity += quantity;
        } else {
            // Add new item if it doesn't exist
            cart.push(cartItem);
        }
        
        localStorage.setItem("cart", JSON.stringify(cart));
        alert(`${quantity} x ${product.name} added to cart!`);
        updateCartCount();
    }
}

// Make sure shared.js is loaded first
if (typeof updateCartCount === 'undefined') {
    console.error('shared.js not loaded properly!');
}
  </script>
</body>
</html>