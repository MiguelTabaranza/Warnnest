<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Product Reviews - Warmnest</title>
    <style>
        * {
            font-family: Arial, sans-serif;
        }

        body {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            margin: 0;
            color: #333;
            font-family: arial, sans-serif;
            background-color: #f4f1ea;
        }

        header {
            position: sticky;
            top: 0;
            z-index: 100;
            font-family: 'merriweather', serif;
            font-size: 1.3rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
            background-color: #e1d7c8;
            border-bottom: 2px solid #745943;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header-search {
            display: flex;
        }

        .header-search input[type="text"] {
            padding: 8px 12px;
            border: 2px solid #5b3d29;
            border-radius: 6px;
            outline: none;
        }

        .header-search button {
            background-color: white;
            border: 1px solid #b09b71;
            border-left: none;
            border-radius: 0 5px 5px 0;
            cursor: pointer;
            padding: 8px 10px;
        }

        .header-center {
            display: flex;
            gap: 20px;
        }

        .header-center a {
            text-decoration: none;
            color: #5c4d37;
            font-weight: 500;
            padding: 5px 15px;
        }

        .header-center a strong {
            color: #5c4d37;
        }

        .header-right {
            display: flex;
            gap: 15px;
        }

        .header-right a {
            text-decoration: none;
            color: #5c4d37;
            font-size: 1em;
        }

        main {
            flex-grow: 1;
            display: flex;
            padding: 20px;
            gap: 30px;
        }

        main > aside {
            width: 200px;
        }

        main > aside h1 {
            margin-top: 0;
            margin-bottom: 15px;
            color: #745943;
            font-size: 1.8rem;
        }

        main > aside hr {
            border: 1px solid #b09b71;
        }

        main > aside ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        main > aside li {
            margin-bottom: 10px;
        }

        main > aside li a {
            text-decoration: none;
            color: #5c4d37;
            display: block;
            padding: 5px 0;
        }

        main > aside li strong a {
            color: #5c4d37;
        }

        .recently-purchased {
            flex: 1;
            padding: 20px;
            border: 2px solid #b09b71;
            border-radius: 5px;
            background-color: #fff;
            color: black;
        }

        .recently-purchased h2 {
            color: #745943;
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 2em;
        }

        .product-item {
            display: grid;
            grid-template-columns: 180px 1fr;
            gap: 20px;
            margin-bottom: 25px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background-color: #fcfcfc;
            cursor: pointer; /* Add cursor pointer to indicate clickability */
        }

        .product-item:last-child {
            margin-bottom: 0;
        }

        .product-image-container {
            width: 180px;
            height: 180px;
            border-radius: 8px;
            overflow: hidden;
            flex-shrink: 0;
        }

        .product-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .product-details {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 5px 0;
        }

        .product-name {
            font-weight: bold;
            margin-bottom: 10px;
            color: #745943;
            font-size: 1.6em;
        }

        .product-description {
            font-size: 1.05em;
            color: #555;
            line-height: 1.5;
            margin-bottom: 15px;
        }

        .star-rating-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .star-rating {
            color: gold;
            font-size: 1.6em;
            white-space: nowrap;
        }

        .star-count {
            font-size: 1.1em;
            color: #666;
        }

        .previous-ratings {
            font-size: 0.95em;
            color: #777;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed #e0e0e0;
            display: none; /* Hidden by default */
            flex-direction: column; /* Make ratings vertical */
        }

        .previous-ratings div { /* Style for individual previous ratings */
            margin-bottom: 5px;
        }

        /* Styles for the new rating form */
        .rating-form {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px dashed #e0e0e0;
        }

        .rating-form label {
            font-weight: bold;
            color: #5c4d37;
        }

        .rating-form select {
            padding: 5px 8px;
            border: 1px solid #b09b71;
            border-radius: 4px;
            background-color: #fcfcfc;
            color: #333;
        }

        .rating-form button {
            background-color: #745943;
            color: white;
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: background-color 0.3s ease;
        }

        .rating-form button:hover {
            background-color: #5c4d37;
        }

        footer {
            text-align: center;
            padding: 20px;
            border-top: 2px solid #745943;
            background-color: #e1d7c8;
            color: #745943;
            margin-top: auto;
        }

        @media (max-width: 768px) {
            header {
                flex-direction: column;
                align-items: center;
            }

            .header-search {
                margin-top: 10px;
                width: 100%;
                max-width: none;
            }

            .header-center {
                display: flex;
                justify-content: center;
                width: 100%;
                margin-top: 10px;
                flex-wrap: wrap;
            }

            .header-center a {
                margin: 5px 10px;
                padding: 10px;
                border-radius: 5px;
                background-color: transparent;
                color: #745943;
                text-decoration: none;
                font-size: 0.9rem;
            }

            main {
                flex-direction: column;
                align-items: center;
            }

            main > aside {
                width: 100%;
                display: flex;
                flex-direction: column;
                align-items: center;
            }

            main > aside ul {
                width: 100%;
                display: flex;
                flex-direction: column;
                align-items: center;
                padding-left: 0;
            }

            main > aside li {
                margin-bottom: 10px;
                text-align: center;
                width: 100%;
            }

            main > aside li a {
                width: 100%;
                text-align: center;
            }

            .recently-purchased {
                align-items: center;
            }

            .product-item {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .product-image-container {
                margin: 0 auto;
                width: 100%;
                max-width: 300px;
                height: auto;
            }

            .product-details {
                align-items: center;
            }
        }
    </style>
</head>
<body>

    <header>
        <div class="header-left">
            <a href="home.html"><img src="images/logo.png" alt="Warmnest Logo" style="height: 30px; width: 30px; margin-right: 10px;"></a>
            <div class="header-search">
                <input type="text" placeholder="Search">
            </div>
        </div>
        <nav class="header-center">
            <a href="store.html">Store</a>
            <a href="home.html">Home</a>
            <a href="customer-support.html">About us</a>
        </nav>
        <div class="header-right">
            <a href="profile.html">ðŸ‘¤</a>
            <a href="wishlist.html">â˜†</a>
            <a href="cart.html">ðŸ›’</a>
        </div>
    </header>

    <main>
        <aside>
            <h1>About Us</h1>
            <hr>
            <ul>
                <li><a href="customer-support.html">Customer Support</a></li>
                <li><strong><a href="product-reviews.html">Product Reviews</a></strong></li>
                <li><a href="return-refund.html">Return & Refund Policy</a></li>
                <li><a href="social-media.html">Social Media</a></li>
                <li><a href="help-center.html">Help Center</a></li>
                <li><a href="live-chat.html">Live Chat Support</a></li>
            </ul>
        </aside>

        <div class="recently-purchased">
            <h2>Recently Purchased Products</h2>
            <div class="product-item" data-product="bean-bag">
                <div class="product-image-container">
                    <img src="images/Wvdb images/Chair/beanbag-4.jpg" alt="Bean Bag" class="product-image">
                </div>
                <div class="product-details">
                    <h3 class="product-name">Cozy Comfort Bean Bag</h3>
                    <p class="product-description">Indulge in ultimate relaxation with our luxurious Bean Bag. Crafted from premium faux leather, it boasts a generous 75 cm diameter and 110 cm height, perfectly filled with fresh virgin polystyrene beans for unparalleled comfort. Double stitching ensures extra strong hold, and a clever lining fabric at the base prevents any bean escapades. Weighing just 5 kg, it's easily moved to your favorite spot.</p>
                    <div class="star-rating-container">
                        <span class="star-rating"></span>
                        <span class="star-count"></span>
                    </div>
                    <div class="previous-ratings"></div>
                    <div class="rating-form">
                        <label for="bean-bag-rating">Rate this product:</label>
                        <select id="bean-bag-rating" name="rating">
                            <option value="5">5 Stars</option>
                            <option value="4">4 Stars</option>
                            <option value="3">3 Stars</option>
                            <option value="2">2 Stars</option>
                            <option value="1">1 Star</option>
                        </select>
                        <button type="button" data-product="bean-bag">Submit Rating</button>
                    </div>
                </div>
            </div>

            <div class="product-item" data-product="sofa">
                <div class="product-image-container">
                    <img src="images/Wvdb images/living room/1.jpg" alt="Sofa" class="product-image">
                </div>
                <div class="product-details">
                    <h3 class="product-name">Elegant Sectional Sofa</h3>
                    <p class="product-description">Transform your living space with our Elegant Sectional Sofa. Designed for both style and comfort, this spacious sofa offers plush seating and a contemporary silhouette. Its durable frame and high-density foam cushions provide lasting support, while the soft, breathable upholstery adds a touch of sophistication. Perfect for family gatherings or unwinding after a long day.</p>
                    <div class="star-rating-container">
                        <span class="star-rating"></span>
                        <span class="star-count"></span>
                    </div>
                    <div class="previous-ratings"></div>
                    <div class="rating-form">
                        <label for="sofa-rating">Rate this product:</label>
                        <select id="sofa-rating" name="rating">
                            <option value="5">5 Stars</option>
                            <option value="4">4 Stars</option>
                            <option value="3">3 Stars</option>
                            <option value="2">2 Stars</option>
                            <option value="1">1 Star</option>
                        </select>
                        <button type="button" data-product="sofa">Submit Rating</button>
                    </div>
                </div>
            </div>

            <div class="product-item" data-product="dining-set">
                <div class="product-image-container">
                    <img src="images/Wvdb images/set/dining.jpg" alt="Dining Set" class="product-image">
                </div>
                <div class="product-details">
                    <h3 class="product-name">Modern Family Dining Set</h3>
                    <p class="product-description">Gather around our stylish Modern Family Dining Set, a perfect blend of functionality and elegance. This set includes a generously sized 120 cm x 80 cm table and four comfortable, matching chairs. Its sleek design and robust construction make it ideal for everyday meals and special occasions, adding a touch of contemporary charm to your dining area.</p>
                    <div class="star-rating-container">
                        <span class="star-rating"></span>
                        <span class="star-count"></span>
                    </div>
                    <div class="previous-ratings"></div>
                    <div class="rating-form">
                        <label for="dining-set-rating">Rate this product:</label>
                        <select id="dining-set-rating" name="rating">
                            <option value="5">5 Stars</option>
                            <option value="4">4 Stars</option>
                            <option value="3">3 Stars</option>
                            <option value="2">2 Stars</option>
                            <option value="1">1 Star</option>
                        </select>
                        <button type="button" data-product="dining-set">Submit Rating</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <p>Â© 2025 Warm Nest Furniture. All rights reserved.</p>
    </footer>

    <script>
        // Initial product ratings (can be fetched from a backend in a real application)
        const productRatings = {
            "bean-bag": 4,
            "sofa": 5,
            "dining-set": 3
        };

        // Initial previous ratings (can be fetched from a backend)
        const previousProductRatings = {
            "bean-bag": [5, 4, 4, 3, 5],
            "sofa": [5, 5, 4, 5],
            "dining-set": [3, 4, 3, 2]
        };

        // Function to generate star rating HTML based on a rating value
        function generateStarRatingHtml(rating) {
            // Ensure rating is between 0 and 5
            rating = Math.max(0, Math.min(5, Math.round(rating)));
            const fullStars = 'â˜…'.repeat(rating);
            const emptyStars = 'â˜†'.repeat(5 - rating);
            return `${fullStars}${emptyStars}`; // Return just the star string
        }

        // Function to calculate and update the average rating
        function updateAverageRating(productName) {
            const ratings = previousProductRatings[productName];
            if (ratings && ratings.length > 0) {
                const sum = ratings.reduce((a, b) => a + b, 0);
                const average = sum / ratings.length; // Keep as float for more precise average display
                productRatings[productName] = average; // Update the main product rating
            } else {
                productRatings[productName] = 0; // No ratings yet
            }
        }

        // Function to render the product reviews
        function renderProductReviews() {
            const productItems = document.querySelectorAll('.product-item');

            productItems.forEach(item => {
                const starRatingContainer = item.querySelector('.star-rating-container');
                const starSpan = starRatingContainer.querySelector('.star-rating');
                const starCountSpan = starRatingContainer.querySelector('.star-count');
                const previousRatingsContainer = item.querySelector('.previous-ratings');
                const productName = item.getAttribute('data-product');

                // Update average rating before rendering
                updateAverageRating(productName);

                // Set current average rating display
                const currentRatingValue = productRatings[productName];
                if (currentRatingValue > 0) {
                    starSpan.textContent = generateStarRatingHtml(currentRatingValue); // Directly set stars
                    // Format the average to one decimal place for display
                    starCountSpan.textContent = `(${currentRatingValue.toFixed(1)} out of 5 stars)`;
                } else {
                    starSpan.textContent = "No rating available.";
                    starCountSpan.textContent = "";
                }

                // Populate previous ratings, limited to the latest 5
                const productPrevRatings = previousProductRatings[productName];
                if (productPrevRatings && productPrevRatings.length > 0) {
                    let prevRatingsHtml = '<strong>Previous Reviews:</strong><br>';
                    // Get only the last 5 ratings
                    const limitedRatings = productPrevRatings.slice(0, 5); // Take the first 5 elements (most recent due to unshift)
                    limitedRatings.forEach((rating) => {
                        prevRatingsHtml += `<div>${generateStarRatingHtml(rating)} (${rating}.0 out of 5 stars)</div>`;
                    });
                    previousRatingsContainer.innerHTML = prevRatingsHtml;
                } else {
                    previousRatingsContainer.innerHTML = "No previous ratings available.";
                }
            });
        }


        document.addEventListener('DOMContentLoaded', function () {
            renderProductReviews(); // Initial render

            const productItems = document.querySelectorAll('.product-item');
            productItems.forEach(item => {
                const previousRatingsContainer = item.querySelector('.previous-ratings');

                // Add click listener to toggle previous ratings visibility
                item.addEventListener('click', function(event) {
                    // Prevent toggling if the click was on the rating form elements
                    if (event.target.closest('.rating-form') || event.target.tagName === 'SELECT' || event.target.tagName === 'BUTTON') {
                        return; // Do nothing if the click is inside the rating form
                    }
                    
                    if (previousRatingsContainer.style.display === 'none' || previousRatingsContainer.style.display === '') {
                        previousRatingsContainer.style.display = 'flex';
                    } else {
                        previousRatingsContainer.style.display = 'none';
                    }
                });
            });

            // Add event listeners for submit rating buttons
            const submitButtons = document.querySelectorAll('.rating-form button');
            submitButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const productName = this.getAttribute('data-product');
                    const selectElement = this.previousElementSibling; // Get the select element
                    const newRating = parseInt(selectElement.value, 10);

                    if (newRating >= 1 && newRating <= 5) {
                        if (!previousProductRatings[productName]) {
                            previousProductRatings[productName] = [];
                        }
                        previousProductRatings[productName].unshift(newRating); // Add new rating to the beginning
                        renderProductReviews(); // Re-render to show the new rating and updated average
                        alert(`Thank you for rating the ${productName.replace('-', ' ').split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ')} ${newRating} stars!`);
                    } else {
                        alert("Please select a valid rating between 1 and 5 stars.");
                    }
                });
            });

        });
    </script>
</body>
</html>